{"version":3,"sources":["webpack:///webpack/bootstrap 62079f95b58b69b771a8","webpack:///./pages/input-drag/main.js","webpack:///./~/spritewerk/src/Camera.js","webpack:///./~/spritewerk/src/Group.js","webpack:///./~/spritewerk/src/Collection.js","webpack:///./~/spritewerk/src/util/index.js","webpack:///./~/spritewerk/src/Sprite.js","webpack:///./~/spritewerk/src/util/contextConstants.js","webpack:///./~/spritewerk/src/Scene.js","webpack:///./~/spritewerk/src/util/math.js","webpack:///./~/spritewerk/src/lib/Transform.js","webpack:///./~/spritewerk/src/shapes/Rectangle.js","webpack:///./~/spritewerk/src/Ticker.js","webpack:///./~/spritewerk/src/util/radio.js","webpack:///./~/spritewerk/src/Viewport.js","webpack:///./~/spritewerk/src/index.js","webpack:///./~/spritewerk/package.json","webpack:///./~/spritewerk/src/util/domHelpers.js","webpack:///./~/spritewerk/src/input/Input.js","webpack:///./~/spritewerk/src/input/dragActionManager.js","webpack:///./~/spritewerk/src/input/mouseInput.js","webpack:///./~/spritewerk/src/input/constants/mouse.js","webpack:///./~/spritewerk/src/input/constants/emulated.js","webpack:///./~/spritewerk/src/input/DragEventManager.js","webpack:///./~/spritewerk/src/util/physics.js"],"names":["size","count","viewport","parent","document","querySelector","fitToWindow","camera","scene","canvas","debug","ticker","screen","grp","rect","draggable","fill","collection","add","onTick","clear","startRender","call","Camera","x","y","width","height","rotation","zoom","Group","sprite","isGroup","Collection","items","item","push","index","getCount","splice","fn","scope","bind","i","len","doContinue","filteredItems","each","predicate","length","fromIndex","indexOf","getIndex","movee","indices","remove","addAt","isAtFront","isAtBack","removee","removed","isNumeric","n","isNaN","parseFloat","isFinite","spriteMatch","a","b","uuid","Sprite","sx","sy","composite","SOURCE_OVER","opacity","visible","uuidCount","parentTransforms","context","globalAlpha","globalCompositeOperation","contextConstants","SOURCE_IN","SOURCE_OUT","SOURCE_ATOP","DESTINATION_OVER","DESTINATION_IN","DESTINATION_OUT","DESTINATION_ATOP","LIGHTER","COPY","XOR","MULTIPLY","SCREEN","OVERLAY","DARKEN","LIGHTEN","COLOR_DODGE","COLOR_BURN","HARD_LIGHT","SOFT_LIGHT","DIFFERENCE","EXCLUSION","HUE","SATURATION","COLOR","LUMINOSITY","defaults","Scene","options","ctx","getContext","transform","xformOffset","cameraXformOffset","cam","translate","rotationOffsetWidth","rotationOffsetHeight","rotate","scaleOffsetWidth","scaleOffsetHeight","scale","transformPoint","setTransform","apply","Array","prototype","slice","matrix","fillStyle","fillRect","clearRect","group","save","_applyCameraTransforms","_applyTransforms","render","renderItem","restore","factor","updateItem","update","degreesToRadians","radiansToDegrees","deg","Math","PI","rad","Transform","stack","reset","m","clone","pop","m11","m12","m21","m22","dx","dy","d","m0","m1","m2","m3","m4","m5","c","cos","s","sin","px","py","Rectangle","w","h","start","Ticker","opts","ticks","then","_update","now","Date","delta","detail","onPreTick","onPostTick","requestAnimationFrame","handlers","_addScopedHandler","event","handler","undefined","scopedHandler","original","scoped","_removeScopedHandler","tuneIn","target","addEventListener","tuneOut","removeEventListener","broadcast","data","evt","MouseEvent","window","CustomEvent","dispatchEvent","Viewport","Object","assign","body","createElement","video","id","viewportStyles","left","position","top","appendChild","_onResize","posCoords","innerWidth","innerHeight","css","console","log","name","version","applyStyles","getScaleFactor","el","styles","key","val","style","elWidth","elHeight","winWidth","winHeight","LANDSCAPE_RATIO","PORTRAIT_RATIO","IS_LANDSCAPE","winLandscapeRatio","winPortraitRatio","offsetLeft","offsetTop","offsetWidth","offsetHeight","cssWidth","parseInt","Input","inputTypes","tree","inputType","init","_onTick","queuedEvents","type","handle","handlerObjects","handlerObj","added","typeFound","eventType","isArray","TypeError","handlerObject","dragee","offset","dragEventManager","MOUSE_DOWN","MOUSE_MOVE","MOUSE_UP","DBL_CLICK","CLICK","DRAG","DRAG_END","DRAG_START","enqueueEvent","clickCandidates","inputEvent","preventDefault","stopPropagation","boundingRect","getBoundingClientRect","scaleFactor","canvasFit","domEvent","ctrlKey","shiftKey","metaKey","button","ceil","pageX","scrollX","pageY","scrollY","concat","getDragEvents","DBL_TAP","TAP","DragEventManager","move","end","startEvent","moveEvent","endEvent","isDragging","canDrag","dragEvents","pointRectCollide","rectRectCollide","rectContain","getBoundingBox","abs","x1","gx","y1","gy","x2","y2","minX","minY","maxX","maxY","bb","rect1","rect2","rect1BB","rect2BB"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 62079f95b58b69b771a8\n **/","import Camera from \"spritewerk/src/Camera\";\nimport Group from \"spritewerk/src/Group\";\nimport Scene from \"spritewerk/src/Scene\";\nimport Rectangle from \"spritewerk/src/shapes/Rectangle\";\nimport Ticker from \"spritewerk/src/Ticker\";\nimport Viewport from \"spritewerk/src/Viewport\";\n// input\nimport Input from \"spritewerk/src/input/Input\";\nimport mouseInput from \"spritewerk/src/input/mouseInput\";\n\n(() => {\n    const size = 512;\n    let count = 9;\n\n    let viewport = new Viewport(size, size, {\n        parent: document.querySelector(\"#spritewerk\"),\n        fitToWindow: false\n    });\n    let camera = new Camera(0, 0, size, size);\n    let scene = new Scene(viewport.canvas, camera, { debug: true });\n    let ticker = new Ticker(viewport.screen);\n    let grp = new Group();\n    \n    new Input(viewport.screen, [mouseInput], grp);\n\n    while (--count) {\n        let rect = new Rectangle(64 * (count - 1), 64 * (count - 1));\n\n        if (count % 2 === 0) {\n            rect.draggable = true;\n            rect.fill = \"#c4c\";\n        } else {\n            rect.fill = \"#4c4\";\n        }\n\n        grp.collection.add(rect);\n    }\n\n    ticker.onTick = ()=> {\n        scene.clear(\"#ccc\");\n        scene.startRender(grp);\n    };\n}).call(this);\n\n\n\n/** WEBPACK FOOTER **\n ** ./pages/input-drag/main.js\n **/","/**\n * @class Camera\n * @param {Integer} [x=0] - The x coordinate\n * @param {Integer} [y=0] - The y coordinate\n * @param {Integer} [width=800] - The viewport width\n * @param {Integer} [height=600] - The viewport height\n */\nexport default class Camera {\n    constructor (x=0, y=0, width=800, height=600) {\n        /**\n         * @member {Integer} Camera#x - The camera's x position\n         */\n        this.x = x;\n        /**\n         * @member {Integer} Camera#y - The camera's y position\n         */\n        this.y = y;\n        /**\n         * @member {Integer} Camera#width - The viewport width\n         */\n        this.width = width;\n        /**\n         * @member {Integer} Camera#height - The viewport height\n         */\n        this.height = height;\n        /**\n         * @member {Float} Camera#rotation - The camera's rotation\n         */\n        this.rotation = 0;\n        /**\n         * @member {Float} Camera#zoom - The camera's zoom value\n         */\n        this.zoom = 1;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Camera.js\n **/","import Collection from \"./Collection\";\nimport Sprite from \"./Sprite\";\n\n/**\n * Composes Sprite and Collection\n * @class Group\n * @requires Collection\n * @requires Sprite\n */\nexport default class Group {\n    constructor () {\n        /**\n         * @member {Collection} Group#collection - The group's collection\n         */\n        this.collection = new Collection();\n        /**\n         * @member {Sprite} Group#sprite - The group's display object\n         */\n        this.sprite = new Sprite();\n        /**\n         * @member {Boolean} Group#isGroup - Denote's the object as a group\n         */\n        this.isGroup = true;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Group.js\n **/","import { spriteMatch } from \"./util\";\n\n/**\n * @class Collection\n * @param {Any} [...items] - optional items to initially add\n */\nexport default class Collection {\n    constructor (...items) {\n        /**\n         * @member {Array} Collection#items - the collection of items\n         */\n        this.items = items || [];\n    }\n\n    /**\n     * Add n items(s)\n     * @method Collection#add\n     * @param  {...Object} items - item(s) to add\n     */\n    add (...items) {\n        for (let item of items) {\n            this.items.push(item);\n        }\n    }\n\n    /**\n     * Add an item at a given index\n     * @method Collection#addAt\n     * @param  {Integer} index - The index to add the item\n     * @param  {Any}     item - The item to add\n     */\n    addAt (index, item) {\n        if (index > this.getCount()) {\n            this.add(item);\n        } else {\n            this.items.splice(index, 0, item);\n        }\n    }\n\n    /**\n     * Iterates the collection's sorted items. The item, index, and name are supplied\n     * to the provided function\n     * @method Collection#each\n     * @param {Function} fn - The function to execute on the iterable\n     * @param {Object} [scope] - The scope with which to execute the function\n     */\n    each (fn, scope) {\n        fn = scope ? fn.bind(scope) : fn;\n\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            let doContinue;\n\n            // if item on last item and an item is removed\n            if (!item) {\n                break;\n            }\n\n            doContinue = fn(item, i);\n\n            if (doContinue === false) {\n                break;\n            }\n        }\n    }\n\n    /**\n     * Returns an object at a given index\n     * @method Collection#fetchAt\n     * @param  {Integer} index - The index\n     * @return {Any}\n     */\n    fetchAt (index) {\n        return this.items[index];\n    }\n\n    /**\n     * iterates items and return the ones that meet criteria\n     * @method Collection#filter\n     * @param  {Function} fn - Truth predicate\n     * @param  {Object} [scope] - The scope in which to execute the function\n     * @return {Array}\n     */\n    filter(fn, scope) {\n        let filteredItems = [];\n\n        this.each((item, i)=> {\n            let predicate = fn(item, i);\n\n            if (predicate) {\n                filteredItems.push(item);\n            }\n        }, scope);\n\n        return filteredItems;\n    }\n\n    /**\n     * Returns the count of items in group\n     * @method Collection#getCount\n     * @return {Integer} - The item count\n     */\n    getCount () {\n        return this.items.length;\n    }\n\n    /**\n     * Returns the given item's index, with optional starting index\n     * @method Collection#getIndex\n     * @param  {Any} item - the item to query\n     * @param  {Integer} [fromIndex] - starting index\n     * @return {Integer} - the item's index\n     */\n    getIndex (item, fromIndex) {\n        return this.items.indexOf(item, fromIndex);\n    }\n\n    /**\n     * Checks if item is at front of render order\n     * @method Collection#isAtFront\n     * @param  {Any} item - The item to query\n     * @return {Boolean} - If item is at front\n     */\n    isAtFront (item) {\n        return this.getIndex(item) === this.getCount() - 1;\n    }\n\n    /**\n     * Checks if item is at back of render order\n     * @method Collection#isAtBack\n     * @param  {Any} item - The item to query\n     * @return {Boolean} - If item is at back\n     */\n    isAtBack (item) {\n        return this.getIndex(item) === 0;\n    }\n\n    /**\n     * Moves an item to a new index\n     * @method Collection#move\n     * @param  {Any} movee - the item to move\n     * @param  {Integer} indices - the amount of indices to shift item. Can be positive/negative\n     * @return {Boolean} - Whether the item was successfully moved\n     */\n    move (movee, indices) {\n        const index = this.getIndex(movee);\n\n        if (indices === 0) {\n            return false;\n        }\n\n        // cannot move before begining (don't use isAtBack to save getIndex use)\n        if (index === 0 && indices < 0) {\n            return false;\n        }\n\n        // cannot move past end (don't use isAtFront to save getIndex use)\n        if (index === this.getCount() - 1 && indices > 0) {\n            return false;\n        }\n\n        this.remove(movee);\n        this.addAt(index + indices, movee);\n\n        return true;\n    }\n\n    /**\n     * Moves an item to the front of the render order\n     * @method Collection#moveToFront\n     * @param  {Any} movee - the item to move\n     * @return {Boolean} - Whether item successfully moved\n     */\n    moveToFront (movee) {\n        if (this.isAtFront(movee)) {\n            return false;\n        }\n\n        this.remove(movee);\n        this.addAt(this.getCount(), movee);\n\n        return true;\n    }\n\n    /**\n     * Moves an item to the back of the render order\n     * @method Collection#moveToBack\n     * @param  {Any} movee - the item to move\n     * @return {Boolean} - Whether item successfully moved\n     */\n    moveToBack (movee) {\n        if (this.isAtBack(movee)) {\n            return false;\n        }\n\n        this.remove(movee);\n        this.addAt(0, movee);\n\n        return true;\n    }\n\n    /**\n     * Remove item by name\n     * @method Collection#removeBy\n     * @param {String} removee - The item to remove\n     * @return {Boolean} - Whether item was successfully removed\n     */\n    remove (removee) {\n        let removed = false;\n\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            if (spriteMatch(item, removee)) {\n                this.items.splice(i, 1);\n                removed = true;\n                break;\n            }\n        }\n\n        return removed;\n    }\n\n    /**\n     * Removes all items\n     * @method Collection#removeAll\n     */\n    removeAll () {\n        this.items = [];\n    }\n\n    /**\n     * Remove item at given index\n     * @method Collection#removeAt\n     * @param {Integer} index - The index of the item to remove\n     */\n    removeAt (index) {\n        this.items.splice(index, 1);\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Collection.js\n **/","/**\n * @namespace util\n */\n\n/**\n * Determine if an input is numeric or not\n * @method isNumeric\n * @memberOf util\n * @param {Any} n - A value to evaluate\n * @return {Boolean}\n */\nconst isNumeric = (n) => !isNaN(parseFloat(n)) && isFinite(n);\n\n/**\n * Determine if two sprites are a match\n * @method spriteMatch\n * @memberOf util\n * @param  {Sprite} a - Sprite a\n * @param  {Sprite} b - Sprite b\n * @return {Boolean} - Whether or not the objects match\n */\nconst spriteMatch = (a, b) => a.uuid === b.uuid;\n\nexport {\n    isNumeric,\n    spriteMatch\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/util/index.js\n **/","import contextConstants from \"./util/contextConstants\";\n\n/**\n * @class Sprite\n * @requires contextConstants\n * \n * @param {Integer} [x=0] - The x coordinate\n * @param {Integer} [y=0] - The y coordinate\n * @param {Integer} [width=64] - The width\n * @param {Integer} [height=64] - The height\n */\nclass Sprite {\n    constructor (x=0, y=0, width=64, height=64) {\n        /**\n         * @member {Integer} Sprite#x - The sprite's x coordinate\n         */\n        this.x = x;\n        /**\n         * @member {Integer} Sprite#y - The sprite's y coordinate\n         */\n        this.y = y;\n        /**\n         * @member {Integer} Sprite#width - The sprite's width\n         */\n        this.width = width;\n        /**\n         * @member {Integer} Sprite#height - The sprite's height\n         */\n        this.height = height;\n        /**\n         * @member {Float} Sprite#sx - The sprite's horizontal scale\n         */\n        this.sx = 1;\n        /**\n         * @member {Float} Sprite#sy - The sprite's horizontal scale\n         */\n        this.sy = 1;\n        /**\n         * @member {Float} Sprite#rotation - The sprite's rotation\n         */\n        this.rotation = 0;\n        /**\n         * @member {Boolean} Sprite#draggable - Whether the sprite can be dragged or not\n         */\n        this.draggable = false;\n        /**\n         * @member {Float} Sprite#composite - The sprite's composite setting\n         */\n        this.composite = contextConstants.SOURCE_OVER;\n        /**\n         * @member {Float} Sprite#opacity - The sprite's opacity\n         */\n        this.opacity = 1;\n        /**\n         * @member {Boolean} Sprite#visible - If false sprite is not rendered\n         */\n        this.visible = true;\n        /**\n         * @member {Float} Sprite#uuid - The sprite's unique ID\n         */\n        this.uuid = Sprite.uuidCount++;\n        /**\n         * @member {Float} Sprite#parentTransforms - A parent group's coordinates\n         */\n        this.parentTransforms = {\n            x: 0, y: 0\n        };\n    }\n    \n    /**\n     * @method Sprite#render\n     * @param  {CanvasRenderingContext2D} context - The rendering context\n     * @return {undefined}\n     */\n    render (context) {\n        context.globalAlpha *= this.opacity;\n\n        if (this.composite !== Sprite.SOURCE_OVER) {\n            context.globalCompositeOperation = this.composite;\n        }\n    }\n\n    /**\n     * A noop\n     * @method Sprite#update\n     * @return {undefined}\n     */\n    update () {}\n    \n    /**\n     * @member {Integer} Sprite#gx - The global x coordinate (the local + parent transforms)\n     */\n    get gx () {\n        return this.x + this.parentTransforms.x;\n    }\n    \n    /**\n     * @member {Integer} Sprite#gy - The global y coordinate (the local + parent transforms)\n     */\n    get gy () {\n        return this.y + this.parentTransforms.y;\n    }\n}\n\nSprite.uuidCount = 0;\n\nexport default Sprite;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Sprite.js\n **/","const contextConstants = {\n    SOURCE_OVER: \"source-over\",\n    SOURCE_IN: \"source-in\",\n    SOURCE_OUT: \"source-out\",\n    SOURCE_ATOP: \"source-atop\",\n    DESTINATION_OVER: \"destination-over\",\n    DESTINATION_IN: \"destination-in\",\n    DESTINATION_OUT: \"destination-out\",\n    DESTINATION_ATOP: \"destination-atop\",\n    LIGHTER: \"lighter\",\n    COPY: \"copy\",\n    XOR: \"xor\",\n    MULTIPLY: \"multiply\",\n    SCREEN: \"screen\",\n    OVERLAY: \"overlay\",\n    DARKEN: \"darken\",\n    LIGHTEN: \"lighten\",\n    COLOR_DODGE: \"color-dodge\",\n    COLOR_BURN: \"color-burn\",\n    HARD_LIGHT: \"hard-light\",\n    SOFT_LIGHT: \"soft-light\",\n    DIFFERENCE: \"difference\",\n    EXCLUSION: \"exclusion\",\n    HUE: \"hue\",\n    SATURATION: \"saturation\",\n    COLOR: \"color\",\n    LUMINOSITY: \"luminosity\"\n};\n\nexport default contextConstants;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/util/contextConstants.js\n **/","import { degreesToRadians } from \"./util/math\";\nimport Transform from \"./lib/Transform\";\n\nlet defaults = {\n    debug: false\n};\n\n/**\n * Handles rendering entities onto the canvas element\n * @class Scene\n * @requires Transform\n * \n * @param {HTMLElement} canvas - The active canvas element\n * @param {Camera} camera - The camera instance\n * @param {Object} [options]\n * @param {Boolean} [options.debug=false] - If true, renders debug objects\n */\nexport default class Scene {\n    constructor (canvas, camera, options=defaults) {\n        /**\n         * @member {HTMLElement} Scene#canvas - The active canvas element\n         */\n        this.canvas = canvas;\n        /**\n         * @member {Camera} Scene#camera - The camera instance\n         */\n        this.camera = camera;\n        /**\n         * @member {HTMLElement} Scene#options - The Scene's options\n         */\n        this.options = options;\n        /**\n         * @member {CanvasRenderingContext2D} Scene#ctx - The canvas rendering object\n         */\n        this.ctx = canvas.getContext(\"2d\");\n        /**\n         * @member {Transform} Scene#transform - The transformation matrix tracker\n         */        \n        this.transform = new Transform();\n\n        this.xformOffset = null;\n        this.cameraXformOffset = null;\n    }\n    \n    /**\n     * Applies the camera's transforms to the Transform > context\n     * @method Scene#_applyCameraTransforms\n     * @param {Camera} cam - The camera instance\n     */\n    _applyCameraTransforms (cam) {\n        this.transform.translate(-cam.x, -cam.y);\n        \n        if (cam.rotation !== 0) {\n            let rotationOffsetWidth = cam.width / 2;\n            let rotationOffsetHeight = cam.height / 2;\n            this.transform.translate(rotationOffsetWidth, rotationOffsetHeight);\n            this.transform.rotate(degreesToRadians(cam.rotation));\n            this.transform.translate(-rotationOffsetWidth, -rotationOffsetHeight);\n        }\n        \n        if (cam.zoom !== 1) {\n            let scaleOffsetWidth = (cam.width / 2) * (cam.zoom - 1);\n            let scaleOffsetHeight = (cam.height / 2) * (cam.zoom - 1);\n            this.transform.translate(-scaleOffsetWidth, -scaleOffsetHeight);\n            this.transform.scale(cam.zoom, cam.zoom);\n        }\n\n        this.cameraXformOffset = this.transform.transformPoint();\n        \n        this.ctx.setTransform.apply(\n            this.ctx, Array.prototype.slice.call(this.transform.matrix)\n        );\n    }\n\n    /**\n     * Applies a Sprite's transforms to the Transform > context\n     * @method Scene#_applyTransforms\n     * @param {Sprite} item - The sprite\n     */\n    _applyTransforms (item) {\n        this.transform.translate(item.x, item.y);\n        this.transform.rotate(degreesToRadians(item.rotation));\n        this.transform.scale(item.sx, item.sy);\n\n        this.xformOffset = this.transform.transformPoint();\n\n        this.ctx.setTransform.apply(\n            this.ctx, Array.prototype.slice.call(this.transform.matrix)\n        );\n    }\n\n    clear (fill) {\n        let canvas = this.canvas;\n\n        if (fill) {\n            this.ctx.fillStyle = fill;\n            this.ctx.fillRect(0, 0, canvas.width, canvas.height);\n        } else {\n            this.ctx.clearRect(0, 0, canvas.width, canvas.height);\n        }\n    }\n\n    /**\n     * [startRender description]\n     * @method Scene#startRender\n     * @param {Group} group The group to render\n     */\n    startRender (group) {\n        this.ctx.save();\n        this.transform.save();\n        \n        this._applyCameraTransforms(this.camera);\n        this._applyTransforms(group.sprite);\n        \n        group.sprite.render(this.ctx);\n\n        group.collection.each((item)=> {\n            this.renderItem(item);\n        });\n\n        this.ctx.restore();\n        this.transform.restore();\n    }\n\n    /**\n     * [renderItem description]\n     * @method Scene#renderItem\n     * @param  {Sprite|Group} item The item to render\n     */\n    renderItem (item) {\n        this.ctx.save();\n        this.transform.save();\n\n        if (item.isGroup) {\n\n            this._applyTransforms(item.sprite);\n\n            if (this.options.debug) {\n                this.ctx.fillRect(-8, -1, 16, 2);\n                this.ctx.fillRect(-1, -8, 2, 16);\n            }\n\n            item.sprite.render(this.ctx);\n            \n            item.collection.each((item)=> {\n                this.renderItem(item);\n            });\n        } else {\n\n            item.parentTransforms = this.transform.transformPoint();\n            // assign parent transforms before applying sprite's transforms\n            this._applyTransforms(item);\n            item.render(this.ctx);\n        }\n\n        this.ctx.restore();\n        this.transform.restore();\n    }\n\n    /**\n     * [startUpdate description]\n     * @method Scene#startUpdate\n     * @param  {Group} group [description]\n     * @param  {Float} factor [description]\n     */\n    startUpdate (group, factor) {\n        group.collection.each((item)=> {\n            this.updateItem(item, factor);\n        });\n    }\n\n    /**\n     * [updateItem description]\n     * @method Scene#updateItem\n     * @param  {Sprite|Group} item [description]\n     * @param  {Float} factor [description]\n     */\n    updateItem (item, factor) {\n        if (item.isGroup) {\n            item.collection.each((item)=> {\n                this.updateItem(item, factor);\n            });\n        } else {\n            item.update(factor);\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Scene.js\n **/","/**\n * @namespace util/math\n */\n\n/**\n * Convert degrees to radians\n * @memberOf util/math\n * @method degreesToRadians\n * @param  {Integer} deg The degrees to convert\n * @return {Float}\n */\nexport function degreesToRadians (deg) {\n    return deg * Math.PI / 180;\n}\n\n/**\n * Convert radians to degrees\n * @memberOf util/math\n * @method radiansToDegrees\n * @param  {Float} rad The radians to convert\n * @return {Integer}\n */\nexport function radiansToDegrees (rad) {\n    return rad * 180 / Math.PI;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/util/math.js\n **/","/*\n * A fork from Simon Sarris\n */\nexport default class Transform {\n    constructor () {\n        this.stack = [];\n        this.reset();\n    }\n    \n    clone () {\n        let m = this.m;\n        return [m[0], m[1], m[2], m[3], m[4], m[5]];\n    }\n\n    reset () {\n        this.m = [1, 0, 0, 1, 0, 0];\n    }\n    \n    save () {\n        this.stack.push(this.clone());\n    }\n    \n    restore () {\n        if (this.stack.length) {\n            let matrix = this.stack.pop();\n            this.m = matrix;\n        }\n    }\n\n    multiply (matrix) {\n        var m11 = this.m[0] * matrix.m[0] + this.m[2] * matrix.m[1];\n        var m12 = this.m[1] * matrix.m[0] + this.m[3] * matrix.m[1];\n\n        var m21 = this.m[0] * matrix.m[2] + this.m[2] * matrix.m[3];\n        var m22 = this.m[1] * matrix.m[2] + this.m[3] * matrix.m[3];\n\n        var dx = this.m[0] * matrix.m[4] + this.m[2] * matrix.m[5] + this.m[4];\n        var dy = this.m[1] * matrix.m[4] + this.m[3] * matrix.m[5] + this.m[5];\n\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n        this.m[4] = dx;\n        this.m[5] = dy;\n    }\n\n    invert () {\n        var d = 1 / (this.m[0] * this.m[3] - this.m[1] * this.m[2]);\n        var m0 = this.m[3] * d;\n        var m1 = -this.m[1] * d;\n        var m2 = -this.m[2] * d;\n        var m3 = this.m[0] * d;\n        var m4 = d * (this.m[2] * this.m[5] - this.m[3] * this.m[4]);\n        var m5 = d * (this.m[1] * this.m[4] - this.m[0] * this.m[5]);\n        this.m[0] = m0;\n        this.m[1] = m1;\n        this.m[2] = m2;\n        this.m[3] = m3;\n        this.m[4] = m4;\n        this.m[5] = m5;\n    }\n\n    rotate (rad) {\n        var c = Math.cos(rad);\n        var s = Math.sin(rad);\n        var m11 = this.m[0] * c + this.m[2] * s;\n        var m12 = this.m[1] * c + this.m[3] * s;\n        var m21 = this.m[0] * -s + this.m[2] * c;\n        var m22 = this.m[1] * -s + this.m[3] * c;\n        this.m[0] = m11;\n        this.m[1] = m12;\n        this.m[2] = m21;\n        this.m[3] = m22;\n    }\n\n    translate (x, y) {\n        this.m[4] += this.m[0] * x + this.m[2] * y;\n        this.m[5] += this.m[1] * x + this.m[3] * y;\n    }\n\n    scale (sx, sy) {\n        this.m[0] *= sx;\n        this.m[1] *= sx;\n        this.m[2] *= sy;\n        this.m[3] *= sy;\n    }\n\n    transformPoint (px=0, py=0) {\n        var x = px;\n        var y = py;\n        px = x * this.m[0] + y * this.m[2] + this.m[4];\n        py = x * this.m[1] + y * this.m[3] + this.m[5];\n        \n        return {\n            x: px,\n            y: py\n        };\n    }\n\n    get matrix () {\n        return this.m;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/lib/Transform.js\n **/","import Sprite from \"../Sprite\";\n\n/**\n * @class Rectangle\n */\nexport default class Rectangle extends Sprite {\n    constructor (x, y, w, h) {\n        super(x, y, w, h);\n        \n        this.fill = \"#000\";\n    }\n\n    render (context) {\n        super.render(context);\n\n        context.fillStyle = this.fill;\n        context.fillRect(0, 0, this.width, this.height);\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/shapes/Rectangle.js\n **/","import { broadcast } from \"./util/radio\";\n\nconst defaults = {\n    start: true\n};\n\n/**\n * @class Ticker\n * @description Executes callback based on given fps and requestAnimationFrame\n * @author Chris Peters\n * \n * @param {Object} [opts] The Ticker's options\n * @param {Boolean} [opts.start=true] Starts timer on instantiation\n */\nexport default class Ticker {\n    constructor(screen, opts=defaults) {\n        this.screen = screen;\n        this.ticks = 0;\n        this.then = null;\n\n        this._update = this._update.bind(this);\n\n        if (opts.start) {\n            this.start();\n        }\n    }\n\n    /**\n     * dispatches events and executes callbacks\n     * @method Ticker#_update\n     */\n    _update() {\n        const now = Date.now();\n        const delta = (now - this.then) / 1000;\n\n        this.then = now;\n        this.ticks += 1;\n\n        const detail = {\n            delta,\n            ticks: this.ticks\n        };\n\n        // create and fire tick events and execute callbacks\n        this.onPreTick(delta, this.ticks);\n        broadcast(this.screen, \"pretick\", detail);\n\n        this.onTick(delta, this.ticks);\n        broadcast(this.screen, \"tick\", detail);\n\n        this.onPostTick(delta, this.ticks);\n        broadcast(this.screen, \"tick\", detail);\n\n        requestAnimationFrame(this._update);\n    }\n\n    /**\n     * A callback executed pre each tick.\n     *\n     * @method Ticker#onPreTick\n     * @param {Integer} delta The time elapsed between ticks\n     * @param {Integer} ticks The amount of ticks that have accumulated\n     */\n    onPreTick() {}\n\n    /**\n     * A callback executed on each tick.\n     *\n     * @method Ticker#onTick\n     * @param {Integer} delta The time elapsed between ticks\n     * @param {Integer} ticks The amount of ticks that have accumulated\n     */\n    onTick() {}\n\n    /**\n     * A callback executed post tick.\n     * @method Ticker#onPostTick\n     * @param {Integer} delta The time elapsed between ticks\n     * @param {Integer} ticks The amount of ticks that have accumulated\n     */\n    onPostTick() {}\n\n    /**\n     * Starts the ticker\n     * @method Ticker#start\n     */\n    start() {\n        this.then = Date.now();\n        requestAnimationFrame(this._update);\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Ticker.js\n **/","let handlers = {};\n\n/**\n * @namespace util/radio\n */\n\n/**\n * @method _addScopedHandler\n * @memberOf util/radio\n * @param  {String}   event    [description]\n * @param  {Function} handler [description]\n * @param  {Object}   scope    [description]\n * @return {Function} The scoped handler\n */\nfunction _addScopedHandler (event, handler, scope) {\n    if (handlers[event] === undefined) {\n        handlers[event] = [];\n    }\n\n    let scopedHandler = scope ? handler.bind(scope) : handler;\n\n    handlers[event].push({\n        original: handler,\n        scoped: scopedHandler\n    });\n\n    return scopedHandler;\n}\n\n/**\n * @method _removeScopedHandler\n * @memberOf util/radio\n * @param  {String}   event   [description]\n * @param  {Function} handler [description]\n * @return {Function}         Returns the scoped handler or original if scope was not passed on `add`\n */\nfunction _removeScopedHandler (event, handler) {\n    let scopedHandler;\n\n    for (let i = 0, len = handlers[event].length; i < len; i++) {\n        if (handler === handler.original) {\n            scopedHandler = handler.scoped;\n            handlers[event].splice(i, 1);\n        }\n    }\n\n    return scopedHandler || handler;\n}\n\n/**\n * @method tuneIn\n * @memberOf util/radio\n * @param {HTMLEntity} target\n * @param {String}     event\n * @param {Function}   handler\n * @param {Object}     [scope]\n */\nfunction tuneIn(target, event, handler, scope) {\n    // we add the handler here (even if no scope is passed) so that we don't have to make the user pass scope\n    // on `remove`\n    handler = _addScopedHandler(event, handler, scope);\n\n    target.addEventListener(event, handler, false);\n}\n\n/**\n * @method tuneOut\n * @memberOf util/radio\n * @param {HTMLEntity} target\n * @param {String}     event\n * @param {Function}   handler\n */\nfunction tuneOut(target, event, handler) {\n    // check that a scoped handler was bound, returns original if not\n    let scopedHandler = _removeScopedHandler(event, handler);\n\n    target.removeEventListener(event, scopedHandler, false);\n}\n\n/**\n * @method broadcast\n * @memberOf util/radio\n * @param {Any}    target\n * @param {String} event\n * @param {Object} data\n */\nfunction broadcast(target, event, data) {\n    let evt;\n\n    switch(event) {\n    // TODO verify MouseEvent\n    case \"click\":\n    case \"dblclick\":\n    case \"mousedown\":\n    case \"mouseup\":\n    case \"mousemove\":\n        evt = new MouseEvent(event, {\n            \"view\": window,\n            \"bubbles\": true,\n            \"cancelable\": false\n        });\n        break;\n    default:\n        evt = new CustomEvent(event, {\n            detail: data\n        });\n        break;\n    }\n\n    target.dispatchEvent(evt);\n}\n\nexport {\n    tuneIn,\n    tuneOut,\n    broadcast\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/util/radio.js\n **/","/* eslint-disable */\nimport index from \"./\";\n/* eslint-enable */\n\nimport { applyStyles, fitToWindow } from \"./util/domHelpers\";\nimport { tuneIn } from \"./util/radio\";\n\nconst defaults = {\n    fitToWindow: true\n};\n\n/**\n * @class Viewport\n * @requires util/domHelpers\n * @requires util/radio\n *\n * @param {Integer} width The game width\n * @param {Integer} height The game height\n * @param {Object} options\n * @param {HTMLElement} [options.parent=document.body] - The parent element\n * @param {Boolean} [options.fitToWindow=true] - If true, the viewport will fill the screen while maintaining aspect ratio\n */\nexport default class Viewport {\n    constructor (width, height, options=defaults) {\n        options = Object.assign(defaults, options);\n\n        // can't set as defaults; throw errors in test env\n        if (options.window === undefined) {\n            options.window = window;\n        }\n        if (options.document === undefined) {\n            options.document = document;\n        }\n        if (options.parent === undefined) {\n            options.parent = options.document.body;\n        }\n\n        /**\n         * @member {Integer} Viewport#width - The viewport's width\n         */\n        this.width = width;\n        /**\n         * @member {Integer} Viewport#height - The viewport's height\n         */\n        this.height = height;\n        /**\n         * @member {Integer} Viewport#options - The viewport's options\n         */\n        this.options = options;\n        /**\n         * @member {HTMLElement} Viewport#canvas - The canvas element\n         */\n        this.canvas = options.document.createElement(\"canvas\");\n        /**\n         * @member {HTMLElement} Viewport#video - The video element\n         */        \n        this.video = options.document.createElement(\"video\");\n        /**\n         * @member {HTMLElement} Viewport#screen - The topmost element to handle UI. Events are also triggered from this element\n         */        \n        this.screen = options.document.createElement(\"canvas\");\n\n        this.canvas.id = \"canvas\";\n        this.video.id = \"video\";\n        this.screen.id = \"screen\";\n\n        this.canvas.width = this.screen.width = width;\n        this.canvas.height = this.screen.height = height;\n\n        const viewportStyles = {\n            height: this.height,\n            left: 0,\n            position: \"absolute\",\n            top: 0,\n            width: this.width\n        };\n    \n        applyStyles(this.canvas, viewportStyles);\n        applyStyles(this.video, viewportStyles);\n        applyStyles(this.screen, viewportStyles);\n\n        options.parent.appendChild(this.canvas);\n        options.parent.appendChild(this.video);\n        options.parent.appendChild(this.screen);\n\n        if (options.fitToWindow) {\n            tuneIn(options.window, \"resize\", this._onResize, this);\n            tuneIn(options.window, \"orientationchange\", this._onResize, this);\n            this._onResize();\n        }\n    }\n\n    /**\n     * @method Viewport#_onResize\n     */\n    _onResize () {\n        const posCoords = fitToWindow(\n            this.width, this.height, this.options.window.innerWidth, this.options.window.innerHeight\n        );\n\n        applyStyles(this.canvas, posCoords);\n        applyStyles(this.video, posCoords);\n        applyStyles(this.screen, posCoords);\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/Viewport.js\n **/","import pkg from \"../package.json\";\n\nconst css = \"background-color:#222; color:#0F0; font-size:16px\";\n\n/* eslint-disable */\nconsole.log(\"%c\" + pkg.name, css);\nconsole.log(\"%cv\" + pkg.version, css);\n/* eslint-enable */\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/index.js\n **/","module.exports = {\n\t\"name\": \"spritewerk\",\n\t\"version\": \"0.2.0\",\n\t\"description\": \"A modern, modular, html5 game development library\",\n\t\"scripts\": {\n\t\t\"docs\": \"jsdoc ./src/* -d ./docs -R README.md -t ./node_modules/minami\",\n\t\t\"lint\": \"eslint ./src\",\n\t\t\"test\": \"babel-node spec/_run.js\",\n\t\t\"build\": \"npm run lint && npm run test\",\n\t\t\"make-playground\": \"./make-playground.sh\",\n\t\t\"watch-playground\": \"webpack --watch --progress --colors\"\n\t},\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"git+https://github.com/bildepunkt/spritewerk.git\"\n\t},\n\t\"keywords\": [\n\t\t\"javascript\",\n\t\t\"js\",\n\t\t\"html5\",\n\t\t\"game\",\n\t\t\"canvas\",\n\t\t\"mobile\"\n\t],\n\t\"author\": {\n\t\t\"name\": \"Chris Peters\",\n\t\t\"url\": \"@bildepunkt\"\n\t},\n\t\"license\": \"ISC\",\n\t\"bugs\": {\n\t\t\"url\": \"https://github.com/bildepunkt/spritewerk/issues\"\n\t},\n\t\"homepage\": \"https://github.com/bildepunkt/spritewerk#readme\",\n\t\"devDependencies\": {\n\t\t\"babel-cli\": \"6.7.7\",\n\t\t\"babel-core\": \"6.7.7\",\n\t\t\"babel-loader\": \"6.2.4\",\n\t\t\"babel-preset-es2015\": \"6.3.13\",\n\t\t\"eslint\": \"3.7.0\",\n\t\t\"jasmine\": \"2.5.2\",\n\t\t\"jasmine-spec-reporter\": \"2.7.0\",\n\t\t\"jsdoc\": \"3.4.1\",\n\t\t\"json-loader\": \"0.5.4\",\n\t\t\"minami\": \"1.1.1\",\n\t\t\"webpack\": \"1.13.2\"\n\t},\n\t\"readme\": \"spritewerk\\n==========\\n\\n[![Build Status](https://travis-ci.org/bildepunkt/spritewerk.svg?branch=master)](https://travis-ci.org/bildepunkt/spritewerk)\\n\\n## A modern, modular, html5 game development library\\nSpritewerk is a lightweight, fun, and easy-to-use solution for producing traditional, console-style games that perform beautifully on any device. The code consists of flexible, generic classes for extending to your own needs, or using right out of the box.\\n\\n### To install\\nEither install with npm\\n\\n    npm install --save spritewerk\\n\\nor clone with git\\n\\n    git clone https://github.com/bildepunkt/spritewerk.git\\n\\nor download archive [here](https://github.com/bildepunkt/spritewerk/archive/master.zip).\\n\\n### To Use\\n`import` classes from `./src` as needed.\\n\\n##### Playground\\nWant to play with Spritewerk right away? To set up a bare-bones development environment run \\n\\n    npm run make-playground\\n\\nthen get webpack to watch changes on `playground/main.js` with:\\n\\n    npm run watch-playground\\n\\n### Test\\nRun Spritewerk's tests with\\n\\n    npm run test\\n\\n### Documentation\\nGenerate Spritewerk's documentation with\\n\\n    npm run doc\\n\\n\\nrequires node `>= 4.2.x`\\n\",\n\t\"readmeFilename\": \"README.md\",\n\t\"gitHead\": \"e4f2dccb8c2650e460e43ff8320440fef67ccc39\",\n\t\"_id\": \"spritewerk@0.2.0\",\n\t\"_shasum\": \"dd45a8f9cedbd81f777695819fe132f6854ce93c\",\n\t\"_from\": \"spritewerk@0.2.0\"\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/spritewerk/package.json\n ** module id = 15\n ** module chunks = 0\n **/","import { isNumeric } from \"./\";\n\n/**\n * @namespace util/domHelpers\n */\n\n/**\n * loops through style object and applies values. Adds \"px\" to numeric values.\n * @memberOf util/domHelpers\n * @method applyStyles\n * @param {HTMLElement} el     The element to apply styles to\n * @param {Object}      styles The key/value pair styles\n */\nexport function applyStyles (el, styles) {\n    for (let key in styles) {\n        let val = styles[key];\n        \n        el.style[key] = isNumeric(val) ? `${val}px` : val;\n    }\n}\n\n/**\n * Returns position & dimensions for a DOM element to fit in the viewport while maintaining aspect ratio\n * @memberOf util/domHelpers\n * @method fitToWindow\n * @param  {Integer} elWidth   The element's original width\n * @param  {Integer} elHeight  The element's original height\n * @param  {Integer} winWidth  The window's current width\n * @param  {Integer} winHeight The window's current height\n * @return {Object}            The calculated left, top, width, height\n */\nexport function fitToWindow (elWidth, elHeight, winWidth, winHeight) {\n    const LANDSCAPE_RATIO = elHeight / elWidth;\n    const PORTRAIT_RATIO  = elWidth / elHeight;\n    const IS_LANDSCAPE    = LANDSCAPE_RATIO < PORTRAIT_RATIO ? true : false;\n    let winLandscapeRatio = winHeight / winWidth;\n    let winPortraitRatio  = winWidth / winHeight;\n    let offsetLeft = 0;\n    let offsetTop  = 0;\n    let offsetWidth;\n    let offsetHeight;\n\n    if (IS_LANDSCAPE) {\n        if (LANDSCAPE_RATIO < winLandscapeRatio) {\n            offsetWidth = winWidth;\n            offsetHeight = offsetWidth * LANDSCAPE_RATIO;\n            offsetTop = (winHeight - offsetHeight) / 2;\n        } else {\n            offsetHeight = winHeight;\n            offsetWidth = winHeight * PORTRAIT_RATIO;\n            offsetLeft = (winWidth - offsetWidth) / 2;\n        }\n    } else {\n        if (PORTRAIT_RATIO < winPortraitRatio) {\n            offsetHeight = winHeight;\n            offsetWidth = winHeight * PORTRAIT_RATIO;\n            offsetLeft = (winWidth - offsetWidth) / 2;\n        } else {\n            offsetWidth = winWidth;\n            offsetHeight = offsetWidth * LANDSCAPE_RATIO;\n            offsetTop = (winHeight - offsetHeight) / 2;\n        }\n    }\n\n    return {\n        width: offsetWidth,\n        height: offsetHeight,\n        left: offsetLeft,\n        top: offsetTop\n    };\n}\n\n/**\n * Returns the factor to multiply event coordinates by. If (with no css scale) x = y, use this function to still get y\n * even when the canvas is scaled via css. ie: `x * getScaleFactor() = y` regardless of css scaling.\n * @method util/getScaleFactor\n * @param  {HTMLElement} canvas - The canvas element\n * @return {Float} The ratio between the canvas' attribute size and its css size\n */\nexport function getScaleFactor (canvas) {\n    let factor = 1;\n    let cssWidth;\n\n    // check if canvas has been scaled via CSS\n    if (canvas.style.width) {\n        cssWidth = parseInt(canvas.style.width, 10);\n        factor = canvas.width / cssWidth;\n    }\n\n    return factor;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/util/domHelpers.js\n **/","import { tuneIn } from \"../util/radio\";\nimport { spriteMatch } from \"../util\";\nimport dragActionManager from \"./dragActionManager\";\n\nconst defaults = {\n    fitToWindow: true\n};\n\n/**\n * @class       input/Input\n * @description A module for handling user input events on the canvas\n * @requires    util/radio\n *\n * @param {HTMLEntity} canvas The canvas element to interact with\n * @param {Array} inputTypes The different event type listeners/handler-executers\n * @param {Object}  [opts]\n * @param {Boolean} [opts.fitToWindow=true] Whether or not to calculate offsets for resized canvas\n */\nexport default class Input {\n    constructor (canvas, inputTypes, tree, opts=defaults) {\n        this.canvas = canvas;\n        this.inputTypes = inputTypes;\n        this.tree = tree;\n\n        if (opts.window === undefined) {\n            opts.window = window;\n        }\n\n        this.options = opts;\n\n        for (let inputType of inputTypes) {\n            inputType.init(canvas, tree, opts);\n        }\n\n        this._onTick = this._onTick.bind(this);\n        tuneIn(this.canvas, \"tick\", this._onTick);\n    }\n\n    /**\n     * Triggers all queued events.\n     * @method Input#_onTick\n     */\n    _onTick () {\n        for (let inputType of this.inputTypes) {\n            for (let event of inputType.queuedEvents) {\n                switch (event.type) {\n                case \"drag\":\n                case \"dragstart\":\n                case \"dragend\":\n                    dragActionManager.handle(event);\n                    break;\n                }\n\n                for (let handlerObj of inputType.handlerObjects[event.type]) {\n                    // if not drag|dragend event, and target given, and it matches OR no target given\n                    // it doesn't apply to drag b/c on fast dragging, the event coordinates will move off the target\n                    // it doesn't apply to dragend b/c a dragend can happen on higher (top-most) target\n                    if (handlerObj.target ) {\n                        if (event.target && spriteMatch(handlerObj.target, event.target)) {\n                            handlerObj.handler(event);\n                        }\n                    } else {\n                        handlerObj.handler(event);\n                    }\n                }\n            }\n\n            inputType.queuedEvents = [];\n        }\n    }\n\n    /**\n     * Adds a handler for the given event type\n     * @method Input#addListener\n     * @param  {Sprite|null} target  The target to check event trigger against, assign `null` to listen for all\n     * @param  {string}      type    The event type\n     * @param  {function}    handler The function to execute when event triggered\n     * @param  {Object}      [scope] The optional scope to assign the handler\n     * @return {boolean}             Returns true if added and false if callback already exists\n     */\n    addListener (target, type, handler, scope) {\n        let added = false;\n        let typeFound = false;\n\n        for (let inputType of this.inputTypes) {\n            let eventType = inputType.handlerObjects[type];\n\n            if (Array.isArray(eventType)) {\n                typeFound = true;\n\n                eventType.push({\n                    handler: scope ? handler.bind(scope) : handler,\n                    original: handler,\n                    target\n                });\n\n                added = true;\n            }\n        }\n\n        if (!typeFound) {\n            throw new TypeError(`Event type \"${type}\" does not exist.`);\n        }\n\n        return added;\n    }\n\n    /**\n     * Removes matching handler if found\n     * @method Input#removeListener\n     * @param  {string}   type    the event type\n     * @param  {function} handler the handler to remove\n     * @return {boolean}  removed Returns true if removed and otherwise false\n     */\n    removeListener(type, handler) {\n        let removed = false;\n        let typeFound = false;\n\n        for (let inputType of this.inputTypes) {\n            let eventType = inputType.handlerObjects[type];\n            typeFound = true;\n\n            if (Array.isArray(eventType)) {\n                for (let i = 0, len = eventType.length; i < len; i++) {\n                    let handlerObject = eventType[i];\n\n                    if (handlerObject.original === handler) {\n                        eventType.splice(i, 1);\n                        removed = true;\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (!typeFound) {\n            throw new TypeError(`Event type \"${type}\" does not exist.`);\n        }\n\n        return removed;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/input/Input.js\n **/","/**\n * Handles actions to take on targets to drag\n * @module dragActionManager\n */\nexport default {\n    dragee: null,\n    offset: {\n        x: 0,\n        y: 0\n    },\n\n    handle (event) {\n        switch (event.type) {\n        case \"dragstart\":\n            if (event.target && event.target.draggable) {\n                this.dragee = event.target;\n                this.offset.x = event.x - this.dragee.x;\n                this.offset.y = event.y - this.dragee.y;\n            }\n            break;\n        case \"drag\":\n            if (this.dragee) {\n                this.dragee.x = event.x - this.offset.x;\n                this.dragee.y = event.y - this.offset.y;\n            }\n            break;\n        case \"dragend\":\n            this.dragee = null;\n            break;\n        }\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/input/dragActionManager.js\n **/","import { tuneIn } from \"../util/radio\";\nimport mouseCnst from \"./constants/mouse\";\nimport emulatedCnst from \"./constants/emulated\";\nimport { getScaleFactor } from \"../util/domHelpers\";\nimport DragEventManager from \"./DragEventManager\";\nimport { pointRectCollide } from \"../util/physics\";\n\n/**\n * @module input/mouseInput\n */\nexport default {\n    /**\n     * @method mouseInput.init\n     * @param  {[type]} canvas    [description]\n     * @param  {Object} opts - Options from Input\n     */\n    init (canvas, tree, opts) {\n        this.canvas = canvas;\n        this.tree = tree;\n        this.opts = opts;\n\n        this.dragEventManager = new DragEventManager(\n            mouseCnst.MOUSE_DOWN,\n            mouseCnst.MOUSE_MOVE,\n            mouseCnst.MOUSE_UP\n        );\n\n        this.handlerObjects = {\n            [mouseCnst.MOUSE_DOWN]: [],\n            [mouseCnst.MOUSE_MOVE]: [],\n            [mouseCnst.MOUSE_UP]: [],\n            [emulatedCnst.DBL_CLICK]: [],\n            [emulatedCnst.CLICK]: [],\n            [emulatedCnst.DRAG]: [],\n            [emulatedCnst.DRAG_END]: [],\n            [emulatedCnst.DRAG_START]: []\n        };\n        this.queuedEvents = [];\n        this.enqueueEvent = this.enqueueEvent.bind(this);\n        this.clickCandidates = [];\n\n        for (let event in mouseCnst) {\n            tuneIn(canvas, mouseCnst[event], this.enqueueEvent);\n        }\n    },\n\n    /**\n     * Handler for DOM events. Creates custom event object with helpful properties\n     * @method mouseInput.enqueueEvent\n     * @param {object} inputEvent - The DOM event object\n     */\n    enqueueEvent (inputEvent) {\n        inputEvent.preventDefault();\n        inputEvent.stopPropagation();\n\n        let boundingRect = this.canvas.getBoundingClientRect();\n        let scaleFactor = this.opts.canvasFit ? getScaleFactor(this.canvas) : 1;\n        let event = {\n            domEvent: inputEvent,\n            type: inputEvent.type,\n            ctrlKey: inputEvent.ctrlKey,\n            shiftKey: inputEvent.shiftKey,\n            metaKey: inputEvent.metaKey,\n            button: inputEvent.button,\n            target: undefined // TODO set to canvas (screen)\n        };\n\n        // coordinate positions relative to canvas scaling\n        event.x = Math.ceil((inputEvent.pageX - (boundingRect.left + this.opts.window.scrollX)) * scaleFactor);\n        event.y = Math.ceil((inputEvent.pageY - (boundingRect.top + this.opts.window.scrollY)) * scaleFactor);\n\n        // find and set target object\n        this.tree.collection.each((item)=> {\n            if (pointRectCollide(event.x, event.y, item)) {\n                event.target = item;\n                // don't break, we want the last-most (highest) item\n            }\n        });\n\n        this.queuedEvents.push(event);\n\n        this.queuedEvents = this.queuedEvents.concat(this.dragEventManager.getDragEvents(event));\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/input/mouseInput.js\n **/","export default {\n    MOUSE_DOWN: \"mousedown\",\n    MOUSE_MOVE: \"mousemove\",\n    MOUSE_UP: \"mouseup\"\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/input/constants/mouse.js\n **/","// we are simulating these events on objects on the canvas, we will not actually listen for these DOM events\nexport default {\n    DRAG: \"drag\",\n    DRAG_END: \"dragend\",\n    DRAG_START: \"dragstart\",\n\n    DBL_CLICK: \"dblclick\",\n    CLICK: \"click\",\n\n    DBL_TAP: \"dbltap\",\n    TAP: \"tap\"\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/input/constants/emulated.js\n **/","import emulatedCnst from \"./constants/emulated\";\n\n/**\n * Provides a common interface for mouse and touch events to emulate drag events\n * @class input/DragEventManager\n * @requires ./constants/emulated\n * @param  {String} start The mouse/touch start event\n * @param  {String} move  The mouse/touch move event\n * @param  {String} end   The mouse/touch end event\n */\nexport default class DragEventManager {\n    constructor (start, move, end) {\n        this.startEvent = start;\n        this.moveEvent = move;\n        this.endEvent = end;\n        this.isDragging = false;\n        this.canDrag = false;\n    }\n\n    getDragEvents (event) {\n        let dragEvents = [];\n\n        // emulate events\n        switch (event.type) {\n        case this.startEvent:\n            this.canDrag = true;\n\n            break;\n        case this.moveEvent:\n            if (this.canDrag) {\n                if (!this.isDragging) {\n                    dragEvents.push(Object.assign({}, event, {\n                        type: emulatedCnst.DRAG_START\n                    }));\n                }\n\n                dragEvents.push(Object.assign({}, event, {\n                    type: emulatedCnst.DRAG\n                }));\n\n                this.isDragging = true;\n            }\n\n            break;\n        case this.endEvent:\n            if (this.isDragging) {\n                dragEvents.push(Object.assign({}, event, {\n                    type: emulatedCnst.DRAG_END\n                }));\n\n                this.isDragging = false;\n            }\n\n            this.canDrag = false;\n            break;\n        }\n\n        return dragEvents;\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/input/DragEventManager.js\n **/","function getBoundingBox (item) {\n    let w = item.width * Math.abs(item.sx);\n    let h = item.height * Math.abs(item.sy);\n    let x1 = item.gx;\n    let y1 = item.gy;\n    let x2 = item.sx >= 0 ? x1 + w : x1 - w;\n    let y2 = item.sy >= 0 ? y1 + h : y1 - h;\n\n    return {\n        minX: x1 <= x2 ? x1 : x2,\n        minY: y1 <= y2 ? y1 : y2,\n        maxX: x1 >= x2 ? x1 : x2,\n        maxY: y1 >= y2 ? y1 : y2\n    };\n}\n\n/**\n * Detects if point is inside a rectangle\n * @method pointRectCollide\n * @memberOf physics\n * @param  {Integer} x    The point's x\n * @param  {Integer} y    The point's y\n * @param  {Sprite}  rect The rect\n * @return {Boolean}\n */\nexport function pointRectCollide (x, y, rect) {\n    let bb = getBoundingBox(rect);\n    return x >= bb.minX && x <= bb.maxX && y >= bb.minY && y <= bb.maxY;\n}\n\n/**\n * Detects whether two rectangles are overlapping\n * @method rectRectCollide\n * @memberOf physics\n * @param  {Sprite} rect1 [description]\n * @param  {Sprite} rect2 [description]\n * @return {Boolean}      \n */\nexport function rectRectCollide (rect1, rect2) {\n    let rect1BB = getBoundingBox(rect1);\n    let rect2BB = getBoundingBox(rect2);\n\n    if (rect1BB.minX < rect2BB.maxX && rect1BB.maxX > rect2BB.minX &&\n        rect1BB.minY < rect2BB.maxY && rect1BB.maxY > rect2BB.minY) {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n/**\n * [rectContain description]\n * @method rectContain\n * @memberOf physics\n * @param  {Sprite} rect [description]\n * @param  {Viewport} viewport [description]\n * @return {Object} Overlap x,y to be added to rect to contain inside viewport\n */\nexport function rectContain (rect, viewport) {\n    let bb = getBoundingBox(rect),\n        x, y;\n\n    if (bb.maxX > viewport.width) {\n        x = viewport.width - bb.maxX;\n    } else if (bb.minX < 0) {\n        x = Math.abs(bb.minX);\n    }\n\n    if (bb.maxY > viewport.height) {\n        y = viewport.height - bb.maxY;\n    } else if (bb.minY < 0) {\n        y = Math.abs(bb.minY);\n    }\n\n    return { x, y };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/spritewerk/src/util/physics.js\n **/"],"sourceRoot":""}